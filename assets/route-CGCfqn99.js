import{r as f,R as N,j as t}from"./jsx-runtime-ByGpHSPZ.js";import{f as se}from"./string-strip-html.esm-ChUPuy61.js";import{E as ie}from"./ErrorSimple-BPKDQex1.js";import{v as x}from"./vars-B3G_A55N.js";import{B as q}from"./Button-OctjQO_e.js";import{I as K,a as ce,b as le}from"./IconBrandX-BxKmVGFY.js";import{A as Y}from"./ActionIcon-CPIfrngI.js";import{c as b}from"./createReactComponent-DG7S5Nwq.js";import{b as _,w as C,u as D,d as me,c as F,g as E,r as de}from"./store-yifqSBJQ.js";import{u as ue}from"./utils-fBPkF14O.js";import{A as k}from"./assets-CxF-pwe_.js";import{S as I}from"./Stack-GgW7hUua.js";import{A as O}from"./AspectRatio-CXJhr6qa.js";import{I as T}from"./Image-BUn1_Jtx.js";import{C as $}from"./Carousel-CQBuA9Hf.js";import{F as pe,I as he}from"./intl-DWyoUv85.js";import{G as j}from"./Group-CypKrXe0.js";import{R as Z,I as fe,r as ge}from"./marketplace-CJ4qS0s5.js";import{D as L}from"./Divider-D3GASQ4J.js";import{T as h}from"./Text-BMjndcdF.js";import{T as xe}from"./Title-BgiDuUci.js";import{u as je}from"./gql-f3x5Sumy.js";import{u as ye,P as ve}from"./PageNavigation-CfgmkjJx.js";import{n as U}from"./date-DZDdvIcB.js";import{c as G}from"./css-utils-Besm3d-a.js";import{a as Ie}from"./date-CIaFKzx_.js";import{u as we,B as g,r as H}from"./factory-CAXpoK4s.js";import{A as ke}from"./Avatar-Dg7oIjsn.js";import{C as ee}from"./Card-DTVDt0jF.js";import{L as be}from"./LoadingOverlay-duN2lep6.js";import{F as Pe,W as Re,T as Se,n as Le,u as _e}from"./url-join-BB64Mf9Y.js";import{T as R}from"./Tooltip-BXhw4mCq.js";import{m as W,A as J}from"./metadata-BHaf7C0V.js";import{g as De,c as X}from"./data-CT1sX_Ze.js";import{P as Ae}from"./PageContainer-B21IHZsm.js";import{S as Ce}from"./Spacer-DsdICkfh.js";import{u as Ee}from"./components-ClcO2DpB.js";import{C as Te}from"./Center-Dz67rf1T.js";import"./index-CMx3RsMM.js";import"./polymorphic-factory-CAua_8H1.js";import"./Loader-CeYn_C2S.js";import"./Transition-DnEPvxi8.js";import"./use-reduced-motion-yJY9mgkS.js";import"./UnstyledButton-DaEZdWNO.js";import"./oauth-p09K5Q4v.js";import"./create-safe-context-jSuPt_P6.js";import"./get-base-value-BwMQOHSn.js";import"./px-CiO0pVtX.js";import"./DirectionProvider-CZrhDgZ9.js";import"./clamp-DTmYCdls.js";import"./AccordionChevron-Cbiw1tIz.js";import"./use-id-CBFaeZXz.js";import"./use-isomorphic-effect-BGcWboEs.js";import"./use-uncontrolled-DgPl9ViR.js";import"./use-merged-ref-BJm5sttg.js";import"./IconArrowRight-C8cXQuKT.js";import"./Paper-ByWL7EOS.js";import"./get-default-z-index-CUjKoHex.js";import"./Overlay-USiVd4QA.js";import"./is-element-CI8e1h0p.js";import"./use-floating-auto-update-DnPUizLK.js";import"./OptionalPortal-BEqzClLW.js";import"./get-style-object-DUJZA7T_.js";import"./Space-CHVQsY9d.js";function Ue({timeout:r=2e3}={}){const[e,n]=f.useState(null),[a,s]=f.useState(!1),[o,i]=f.useState(null),c=u=>{window.clearTimeout(o),i(window.setTimeout(()=>s(!1),r)),s(u)};return{copy:u=>{"clipboard"in navigator?navigator.clipboard.writeText(u).then(()=>c(!0)).catch(l=>n(l)):n(new Error("useClipboard: navigator.clipboard is not supported"))},reset:()=>{s(!1),n(null),window.clearTimeout(o)},error:e,copied:a}}const Be={timeout:1e3};function te(r){const{children:e,timeout:n,value:a,...s}=we("CopyButton",Be,r),o=Ue({timeout:n}),i=()=>o.copy(a);return N.createElement(N.Fragment,null,e({copy:i,copied:o.copied,...s}))}te.displayName="@mantine/core/CopyButton";var ze=b("check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),Me=b("copy","IconCopy",[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]]),Ne=b("heart","IconHeart",[["path",{d:"M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572",key:"svg-0"}]]),Fe=b("map-pin-filled","IconMapPinFilled",[["path",{d:"M18.364 4.636a9 9 0 0 1 .203 12.519l-.203 .21l-4.243 4.242a3 3 0 0 1 -4.097 .135l-.144 -.135l-4.244 -4.243a9 9 0 0 1 12.728 -12.728zm-6.364 3.364a3 3 0 1 0 0 6a3 3 0 0 0 0 -6z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),Oe=b("mood-empty","IconMoodEmpty",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 10l.01 0",key:"svg-1"}],["path",{d:"M15 10l.01 0",key:"svg-2"}],["path",{d:"M9 15l6 0",key:"svg-3"}]]);const $e=r=>t.jsx(q,{variant:"filled",color:x("color-primary-6"),leftSection:t.jsx(K,{}),component:"a",href:`https://api.whatsapp.com/send?phone=62${r.number}&text=Saya%20Tertarik%20dengan%20jualan%20Anda`,target:"_blank",children:"Hubungi Penjual"}),Ge=()=>t.jsx(Y,{variant:"subtle",color:"red",children:t.jsx(Ne,{})});_(0);const B=_(null),re=_(null),P=_(null),He=({initialSelectedVariant:r,initialSelectedImage:e})=>(ue([[P,r],[B,e]],{dangerouslyForceHydrate:!0}),null),We="_hoverableImage_39g91_3",Je={hoverableImage:We},Xe=({images:r})=>{const[e,n]=C(B),[a,s]=C(re);return t.jsxs(I,{children:[t.jsx(O,{ratio:1,style:{borderRadius:x("radius-sm"),overflow:"hidden"},children:t.jsx(T,{h:"100%",w:"100%",src:k.marketItem({file:a?a.URL:(e==null?void 0:e.URL)??r[0].URL}),alt:e==null?void 0:e.caption})}),t.jsx($,{align:"start",slideSize:"25%",slideGap:"sm",withControls:!1,children:r.map(o=>t.jsx($.Slide,{children:t.jsx(O,{ratio:1,children:t.jsx(T,{w:"100%",src:k.marketItem({file:o.URL}),alt:o.caption,className:Je.hoverableImage,"data-is-active":o.ID===(a==null?void 0:a.ID),onClick:()=>n(o),onMouseEnter:()=>{n(o),s(o)},style:{overflow:"hidden",borderRadius:x("radius-md")}})})},o.ID))})]})},Ve=r=>{var e;return t.jsxs(I,{gap:0,children:[t.jsxs(j,{gap:"xs",children:[t.jsx(Z,{value:r.rating,readOnly:!0}),t.jsx(L,{orientation:"vertical"}),t.jsxs(h,{fz:14,component:"span",children:["Penilaian",t.jsxs(h,{component:"span",ml:3,c:x("color-dimmed"),children:["(",pe.format(r.ratingN??0),")"]})]}),t.jsx(L,{orientation:"vertical"}),t.jsxs(j,{gap:3,children:[t.jsx(fe,{size:16,style:{color:x("color-gray-7")}}),t.jsx(h,{fz:14,children:(e=r.category)==null?void 0:e.name})]})]}),t.jsxs(j,{gap:5,hidden:!0,children:[t.jsx(Fe,{size:16,style:{color:x("color-gray-7")}}),t.jsx(h,{fz:14,children:"Lokasi Jualan"})]})]})};function Qe({productName:r,fz:e}){const n=D(P);return t.jsx(xe,{fz:e,fw:500,tt:"capitalize",children:`${r}${n!=null&&n.name?` - ${n.name}`:""}`})}function qe({fz:r}){const e=D(P);return t.jsx(h,{fz:r,fw:"bold",children:he.formatNoSpace(+((e==null?void 0:e.price)??0))})}const Ke="_hideLastOfType_12tdt_2",Ye={hideLastOfType:Ke},Ze=r=>t.jsxs(g,{children:[t.jsxs(j,{children:[t.jsx(ke,{src:r.photoURL,alt:r.name,radius:"xl"}),t.jsxs(g,{children:[t.jsxs(j,{gap:"xs",children:[t.jsx(h,{size:"sm",children:r.name}),t.jsx(L,{orientation:"vertical"}),t.jsx(Z,{value:r.rating,readOnly:!0})]}),t.jsx(h,{size:"xs",c:"dimmed",children:r.date})]})]}),t.jsx(h,{pl:54,pt:"sm",size:"sm",children:r.comment})]}),et=({productID:r})=>{var l;const{limit:e,cursor:n,currentPage:a,isTouched:s,isEmpty:o,nextCursor:i,prevCursor:c,addResult:d}=ye(5),[{data:p,fetching:u}]=je({query:ge,variables:{limit:e,cursor:n,itemID:r}});return f.useEffect(()=>{u!=!0&&(p==null?void 0:p.reviews)!=null&&d(p.reviews)},[d,p,u]),t.jsxs(ee,{withBorder:!0,children:[t.jsx(I,{children:(l=a.items)==null?void 0:l.map(m=>{var v,w;return t.jsxs(f.Fragment,{children:[t.jsx(Ze,{name:((v=m.user)==null?void 0:v.name)??"-",rating:m.rating,comment:m.comment,date:Ie(U(m.updatedAt)),photoURL:k.mobileUser({file:(w=m.user)==null?void 0:w.photoURL})},m.ID),t.jsx(L,{className:Ye.hideLastOfType,color:x("color-gray-1")})]},m.ID)})}),t.jsxs(g,{display:G(o||u),pos:"relative",children:[t.jsx(be,{visible:u,zIndex:1e3,overlayProps:{radius:"sm",blur:2}}),t.jsxs(j,{p:20,gap:10,justify:"center",children:[t.jsx(Oe,{color:x("color-gray-5")}),t.jsx(h,{fz:18,c:x("color-gray-5"),children:"Tidak ada ulasan untuk saat ini"})]})]}),t.jsx(g,{display:G(s&&!o),children:t.jsx(g,{p:20,children:t.jsx(ve,{onPrev:c,onNext:i,isPrevDisabled:u||a.isFirstPage,isNextDisabled:u||a.isLastPage||!s})})})]})},tt=new RegExp("([\\p{Ll}\\d])(\\p{Lu})","gu"),rt=new RegExp("(\\p{Lu})([\\p{Lu}][\\p{Ll}])","gu"),at=new RegExp("(\\d)\\p{Ll}|(\\p{L})\\d","u"),nt=/[^\p{L}\d]+/giu,V="$1\0$2",Q="";function ae(r){let e=r.trim();e=e.replace(tt,V).replace(rt,V),e=e.replace(nt,"\0");let n=0,a=e.length;for(;e.charAt(n)==="\0";)n++;if(n===a)return[];for(;e.charAt(a-1)==="\0";)a--;return e.slice(n,a).split(/\0/g)}function ot(r){const e=ae(r);for(let n=0;n<e.length;n++){const a=e[n],s=at.exec(a);if(s){const o=s.index+(s[1]??s[2]).length;e.splice(n,1,a.slice(0,o),a.slice(o))}}return e}function st(r,e){const[n,a,s]=ct(r,e);return n+a.map(it(e==null?void 0:e.locale)).join((e==null?void 0:e.delimiter)??" ")+s}function z(r,e){return st(r,{delimiter:"-",...e})}function it(r){return r===!1?e=>e.toLowerCase():e=>e.toLocaleLowerCase(r)}function ct(r,e={}){const n=e.split??(e.separateNumbers?ot:ae),a=e.prefixCharacters??Q,s=e.suffixCharacters??Q;let o=0,i=r.length;for(;o<r.length;){const c=r.charAt(o);if(!a.includes(c))break;o++}for(;i>o;){const c=i-1,d=r.charAt(c);if(!s.includes(d))break;i=c}return[r.slice(0,o),n(r.slice(o,i)),r.slice(i)]}function lt({url:r}){const e=D(P),n=f.useMemo(()=>(e==null?void 0:e.ID)==null?r:e.name==null||e.name==""?r+"?v_id="+e.ID:`${r}?v_id=${e.ID}&v_name=${z(e.name)}`,[e,r]);return t.jsxs(j,{children:[t.jsx(h,{mb:7,children:"Bagikan:"}),t.jsx(Pe,{url:n,children:t.jsx(R,{label:"Facebook",withArrow:!0,children:t.jsx(ce,{color:"gray",size:24})})}),t.jsx(Re,{url:n,children:t.jsx(R,{label:"WhatsApp",withArrow:!0,children:t.jsx(K,{color:"gray",size:24})})}),t.jsx(Se,{url:n,children:t.jsx(R,{label:"Twitter/X",withArrow:!0,children:t.jsx(le,{color:"gray",size:24})})}),t.jsx(te,{value:n,timeout:2e3,children:({copied:a,copy:s})=>t.jsx(R,{label:a?"Berhasil disalin":"Salin tautan",withArrow:!0,children:t.jsx(Y,{color:a?"teal":"gray",variant:"subtle",onClick:s,mb:7,ml:-2,children:a?t.jsx(ze,{style:{width:H(24)}}):t.jsx(Me,{style:{width:H(24)}})})})})]})}const mt=({productName:r,images:e,variants:n})=>{const[a,s]=C(P),o=D(me),i=F(re),c=F(B),d=f.useMemo(()=>Object.fromEntries(e.map(l=>[l.ID,l])),[e]),[p,u]=f.useState(!1);return f.useEffect(()=>{if(a==null)return;const l=E("ID"),m=r+(a.name==""?"":` - ${a.name}`),v=de(l.DESA_PROFILE_PAGE_TITLE,{desa_fullname:o,page_name:m});typeof document<"u"&&(document.title=v)},[o,r,a]),f.useEffect(()=>{if(typeof window>"u"||window.location==null||window.location.href==null||typeof history>"u"||p==!1)return;const l=new URL(window.location.href),m=l.searchParams;for(;;){if(a==null){m.delete("v_id"),m.delete("v_name");break}m.set("v_id",a.ID+""),a.name==""?m.delete("v_name"):m.set("v_name",z(a.name));break}history.replaceState({},"",l)},[p,a]),f.useEffect(()=>{if(a==null)return;const l=d[a.photoID];l&&c(l)},[d,a,c]),t.jsxs(I,{gap:"xs",children:[t.jsx(h,{fz:22,fw:"bold",children:"Jenis:"}),t.jsx(j,{children:n.map(l=>{const m=d[l.photoID];return t.jsx(q,{leftSection:m&&t.jsx(T,{src:k.marketItem({file:m.URL}),w:20,h:20,alt:m.caption}),variant:(a==null?void 0:a.ID)===l.ID?"filled":"default",color:(a==null?void 0:a.ID)===l.ID?x("color-primary-3"):void 0,onMouseEnter:()=>m&&i(m),onMouseLeave:()=>m&&i(null),onClick:()=>{s(l),u(!0)},children:l.name||"Standar"},l.ID)})})]})},dt=r=>r.media.find(e=>e.ID===r.defaultPhoto.ID),ut=(r,e)=>r.media.find(n=>n.ID===e.photoID),ne=(r,e)=>e.name==""?r.name:`${r.name} - ${e.name}`,pt=(r,e)=>{const n=e?new URLSearchParams(e.search):new URLSearchParams("");return n.set("v_id",r.ID+""),r.name==""?n.delete("v_name"):n.set("v_name",z(r.name)),n.toString()},ht="_gallery_pfltv_3",ft="_content_pfltv_7",gt="_container_pfltv_11",A={gallery:ht,content:ft,container:gt};var y;(r=>{r.Root=Ae,r.Container=e=>t.jsx(ee,{bg:"rgba(255, 255, 255, 0.5)",withBorder:!0,...e,children:t.jsx(g,{className:A.container,...e})}),r.Gallery=({children:e})=>t.jsx(g,{className:A.gallery,children:t.jsx("div",{children:e})}),r.Content=({children:e})=>t.jsx(g,{className:A.content,children:e}),r.Review=({children:e,...n})=>t.jsxs(I,{...n,children:[t.jsx(Ce,{}),t.jsxs(g,{children:[t.jsx(h,{fz:18,fw:700,mb:10,tt:"uppercase",children:"Ulasan Pembeli"}),e]})]})})(y||(y={}));function xt(r,e){const{baseUrl:n,product:a,variant:s}=r,o=e.get("v_id"),i=M(n,s,e),c={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"Beli",item:Le(_e(n,"../../"))},{"@type":"ListItem",position:2,name:a.name,item:n}]};return o!=null&&o!==""&&c.itemListElement.push({"@type":"ListItem",position:3,name:s.name===""?"Standar":s.name,item:i}),c}const S=r=>({url:k.marketItem({file:r.URL}),alt:r.caption});function oe(r,e){const{variant:n,product:a}=r;if(a.media.length===1)return[S(a.media[0])];const s=e.get("v_id");if(s==null||s==="")return a.media.map((i,c)=>[c,i]).sort((i,c)=>i[1].ID===n.photoID?-1:i[0]-c[0]).map(i=>S(i[1]));const o=a.media.find(i=>i.ID===n.photoID);return o==null?[S(a.media[0])]:[S(o)]}function jt(r,e){const{baseUrl:n,product:a,variant:s,reviews:o}=r,i=M(n,s,e),c={"@context":"https://schema.org","@type":"Product",name:ne(a,s),description:a.description,image:oe(r,e).map(d=>d.url),offers:{"@type":"Offer",url:i,price:s.price,priceCurrency:"IDR",availability:s.isLimitedByStock==!1||s.stock>0?"InStock":"OutOfStock"}};return o.length<=0||a.reviews<=0||(c.aggregateRating={"@type":"AggregateRating",reviewCount:a.reviews,ratingValue:a.rating,bestRating:5,worstRating:0},c.review=o.map(d=>{var p;return{"@type":"Review",reviewRating:{"@type":"Rating",ratingValue:d.rating},author:{"@type":"Person",name:(p=d.user)==null?void 0:p.name},reviewBody:d.comment,dateCreated:U(d.createdAt).toISOString(),dateModified:U(d.updatedAt).toISOString()}})),c}const M=(r,e,n)=>{const a=n.get("v_id");return a==null||a===""?r:r+"?"+pt(e)},_r=({data:r,location:e,matches:n})=>{var w;const a=De(n);if(a==null)return[];const{profile:s,host:o,locale:i}=a;if(r==null)return[...W({...X(E(i),o,s,{title:"Produk tidak ditemukan",description:"Produk yang Anda coba buka tidak ada. Anda mungkin salah mengetik alamatnya, atau produknya telah dipindahkan ke URL lain. Jika Anda menganggap ini adalah kesalahan, hubungi kami."}),creator:["PT Digital Desa Indonesia"]})];const{product:c,variant:d,baseUrl:p}=r,u=new URLSearchParams(e.search),l=M(p,d,u),m=ne(c,d),v=((w=c.user)==null?void 0:w.name)??"[User dihapus]";return[...W({...X(E(i),o,s,{title:m,description:se(c.description).result}),creator:[v,"PT Digital Desa Indonesia"],canonical:l,"og:url":l,"og:image":oe(r,u),"og:type":"product","product:plural_title":m,"product:price.amount":d.price,"product:price.currency":"IDR"}),J.RichData.breadcrumb(xt(r,u)),J.RichData.product(jt(r,u))]};function Dr(){var i;const r=Ee(),{product:e,variant:n,baseUrl:a,id:s}=r,o=e.variants.length===1;return t.jsxs(y.Root,{children:[t.jsx(He,{initialSelectedImage:ut(e,n)??dt(e),initialSelectedVariant:n}),t.jsxs(y.Container,{children:[t.jsx(y.Gallery,{children:t.jsx(Xe,{images:e.media})}),t.jsxs(y.Content,{children:[t.jsxs(j,{align:"flex-start",children:[t.jsxs(I,{gap:5,style:{flexGrow:1},children:[t.jsx(Qe,{productName:e.name,fz:32}),t.jsx(Ve,{ratingN:e.reviews,rating:e.rating,category:e.category,views:e.views??0})]}),t.jsx(Ge,{})]}),t.jsx(qe,{fz:32}),t.jsx(h,{mt:24,children:e.description}),!o&&t.jsx(mt,{productName:e.name,images:e.media,variants:e.variants}),t.jsx(g,{mt:20,children:t.jsx($e,{number:e.phone??((i=e.user)==null?void 0:i.phone)??""})}),t.jsx(lt,{url:a})]})]}),t.jsx(y.Review,{mt:16,children:t.jsx(et,{productID:s})})]})}function Ar(){return t.jsx(Te,{mih:"100vh",children:t.jsx(g,{maw:"85%",children:t.jsx(ie,{title:"Produk tidak ditemukan",message:"Produk yang Anda coba buka tidak ada. Anda mungkin salah mengetik alamatnya, atau produknya telah dipindahkan ke URL lain. Jika Anda menganggap ini adalah kesalahan, hubungi kami.",icon:404,mainUrl:"https://profil.digitaldesa.id"})})})}export{Ar as ErrorBoundary,Dr as default,_r as meta};
